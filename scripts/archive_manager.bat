@echo off
chcp 65001 >nul
title PWM Generator - Archive Manager

:menu
cls
echo ===============================================
echo     PWM GENERATOR - ARCHIVE MANAGER
echo ===============================================
echo.
echo Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ:
echo.
echo [1] Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð°Ñ€Ñ…Ð¸Ð² Ð´Ð»Ñ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð° (Read-Only)
echo [2] Ð‘Ñ‹ÑÑ‚Ñ€Ð¾Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÐºÐ»Ð¸ÐµÐ½Ñ‚ÑÐºÐ¾Ð³Ð¾ Ð°Ñ€Ñ…Ð¸Ð²Ð°
echo [3] Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð°Ñ€Ñ…Ð¸Ð² Ñ Ð¸ÑÑ…Ð¾Ð´Ð½Ñ‹Ð¼ ÐºÐ¾Ð´Ð¾Ð¼
echo [4] ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾Ð± Ð°Ñ€Ñ…Ð¸Ð²Ð°Ñ…
echo [5] ÐžÑ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ ÑÑ‚Ð°Ñ€Ñ‹Ðµ Ð°Ñ€Ñ…Ð¸Ð²Ñ‹
echo [0] Ð’Ñ‹Ñ…Ð¾Ð´
echo.
set /p choice="Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð½Ð¾Ð¼ÐµÑ€ (0-5): "

if "%choice%"=="1" goto create_readonly
if "%choice%"=="2" goto quick_update
if "%choice%"=="3" goto create_source
if "%choice%"=="4" goto show_info
if "%choice%"=="5" goto cleanup
if "%choice%"=="0" goto exit
goto menu

:create_readonly
cls
echo ===============================================
echo     Ð¡ÐžÐ—Ð”ÐÐÐ˜Ð• ÐÐ Ð¥Ð˜Ð’Ð Ð”Ð›Ð¯ ÐšÐ›Ð˜Ð•ÐÐ¢Ð
echo ===============================================
echo.
echo Ð¡Ð¾Ð·Ð´Ð°ÐµÑ‚ÑÑ Ð¿Ð¾Ð»Ð½Ñ‹Ð¹ Ð°Ñ€Ñ…Ð¸Ð² Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸ÐµÐ¹...
echo.
call update_archive.bat
echo.
echo ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð»ÑŽÐ±ÑƒÑŽ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ Ð´Ð»Ñ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð° Ð² Ð¼ÐµÐ½ÑŽ...
pause >nul
goto menu

:quick_update
cls
echo ===============================================
echo     Ð‘Ð«Ð¡Ð¢Ð ÐžÐ• ÐžÐ‘ÐÐžÐ’Ð›Ð•ÐÐ˜Ð• ÐÐ Ð¥Ð˜Ð’Ð
echo ===============================================
echo.
echo ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÑ‚ÑÑ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ð¹ Ð°Ñ€Ñ…Ð¸Ð²...
echo.
call quick_update.bat
echo.
echo ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð»ÑŽÐ±ÑƒÑŽ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ Ð´Ð»Ñ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð° Ð² Ð¼ÐµÐ½ÑŽ...
pause >nul
goto menu

:create_source
cls
echo ===============================================
echo     Ð¡ÐžÐ—Ð”ÐÐÐ˜Ð• ÐÐ Ð¥Ð˜Ð’Ð Ð¡ Ð˜Ð¡Ð¥ÐžÐ”ÐÐ«Ðœ ÐšÐžÐ”ÐžÐœ
echo ===============================================
echo.
echo Ð¡Ð¾Ð·Ð´Ð°ÐµÑ‚ÑÑ Ð°Ñ€Ñ…Ð¸Ð² Ð´Ð»Ñ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ°...
echo.
call create_source_archive.bat
echo.
echo ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð»ÑŽÐ±ÑƒÑŽ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ Ð´Ð»Ñ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð° Ð² Ð¼ÐµÐ½ÑŽ...
pause >nul
goto menu

:show_info
cls
echo ===============================================
echo     Ð˜ÐÐ¤ÐžÐ ÐœÐÐ¦Ð˜Ð¯ ÐžÐ‘ ÐÐ Ð¥Ð˜Ð’ÐÐ¥
echo ===============================================
echo.
echo ðŸ“¦ ÐÐ°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ðµ Ð°Ñ€Ñ…Ð¸Ð²Ñ‹:
echo.
for %%f in (*.zip) do (
    echo ðŸ“„ %%f
    for %%A in ("%%f") do echo    Ð Ð°Ð·Ð¼ÐµÑ€: %%~zA Ð±Ð°Ð¹Ñ‚
    for %%A in ("%%f") do echo    Ð”Ð°Ñ‚Ð°: %%~tA
    echo.
)
echo.
echo ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð»ÑŽÐ±ÑƒÑŽ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ Ð´Ð»Ñ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð° Ð² Ð¼ÐµÐ½ÑŽ...
pause >nul
goto menu

:cleanup
cls
echo ===============================================
echo     ÐžÐ§Ð˜Ð¡Ð¢ÐšÐ Ð¡Ð¢ÐÐ Ð«Ð¥ ÐÐ Ð¥Ð˜Ð’ÐžÐ’
echo ===============================================
echo.
echo Ð’ÐÐ˜ÐœÐÐÐ˜Ð•: Ð‘ÑƒÐ´ÑƒÑ‚ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹ Ð²ÑÐµ Ð°Ñ€Ñ…Ð¸Ð²Ñ‹ ÑÑ‚Ð°Ñ€ÑˆÐµ 7 Ð´Ð½ÐµÐ¹!
echo.
set /p confirm="ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ? (y/n): "
if /i not "%confirm%"=="y" goto menu

echo.
echo Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚Ð°Ñ€Ñ‹Ñ… Ð°Ñ€Ñ…Ð¸Ð²Ð¾Ð²...
forfiles /m *.zip /d -7 /c "cmd /c del @path" 2>nul
echo âœ“ ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°
echo.
echo ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Ð»ÑŽÐ±ÑƒÑŽ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ Ð´Ð»Ñ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð° Ð² Ð¼ÐµÐ½ÑŽ...
pause >nul
goto menu

:exit
cls
echo ===============================================
echo     Ð’Ð«Ð¥ÐžÐ” Ð˜Ð— ÐÐ Ð¥Ð˜Ð’ ÐœÐ•ÐÐ•Ð”Ð–Ð•Ð Ð
echo ===============================================
echo.
echo Ð”Ð¾ ÑÐ²Ð¸Ð´Ð°Ð½Ð¸Ñ!
echo.
timeout /t 2 >nul
exit /b 0
